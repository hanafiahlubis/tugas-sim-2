<!DOCTYPE html>
<html>
  <head>
    <title>Tugas Sim</title>
    <style type="text/css">
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        width: 100%;
        /* height: 100vh; */
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        letter-spacing: 1px;
        background-color: #0c1022;
        /* gap: 2rem; */
        margin: 1rem;
      }
      .red {
        color: #fb667a;
      }
      h2 a {
        text-decoration: none;
        color: #fb667a;
        text-transform: lowercase;
        font-weight: 900;
      }
      h2 > a > span {
        text-transform: uppercase;
      }
      .container {
        margin: auto;
        margin-top: 8px;
        border-collapse: collapse;
        overflow: hidden;
        text-align: left;
        font-size: 20px;
      }
      .container th,
      .container td {
        width: 200px;
        padding: 10px;
      }
      .container td {
        box-shadow: 1px 1px 3px -1px #000;
      }
      .container th {
        color: #fff842;
        text-align: center;
        background-color: #1f2739;
      }
      .container td:first-child {
        color: #fb667a;
      }
      .container tr:nth-child(odd) {
        background-color: #323c50;
      }
      .container tr:nth-child(even) {
        background-color: #2c3446;
      }
      td {
        color: #4dc3fa;
      }
      .container td:hover,
      th:hover {
        background-color: #fff842;
        color: #1f2739;
        font-weight: bold;
        box-shadow: -6px 6px 0 0 #7f7c21, -5px 5px 0 0 #7f7c21,
          -4px 4px 0 0 #7f7c21, -3px 3px 0 0 #7f7c21, -2px 2px 0 0 #7f7c21,
          -1px 1px 0 0 #7f7c21;
        transform: translate3d(6px, -6px, 0px);
        transition: all 0.5s;
        cursor: pointer;
      }
      .sidepanel {
        display: none;
        left: 27%;
        position: fixed;
        z-index: 100;
        height: 21rem;
        top: 0;
        background-color: #0c1022;
        transition: 0.5s;
        padding-top: 60px;
        overflow: hidden;
      }

      .sidepanel a {
        color: #00ccff;
        padding: 8px 8px 8px 32px;
        text-decoration: none;
        font-size: 17px;
        display: block;
        transition: 0.3s;
      }

      .sidepanel a:hover {
        color: #ee00ff;
      }

      .sidepanel .close-btn {
        position: absolute;
        top: 0px;
        right: 25px;
        font-size: 36px;
      }

      .open-btn {
        left: 27%;
        top: 0%;
        font-size: 20px;
        cursor: pointer;
        background-color: #0c1022;
        padding: 10px 15px;
        border: none;
        color: #00ccff;
        position: fixed;
      }

      .open-btn:hover {
        background-color: #444;
      }
    </style>
  </head>
  <body>
    <h2 class="red">Lembar Perhitungan 4</h2>
    
  <div id="my-sidepanel" class="sidepanel">
    <a href="javascript:void(0)" class="close-btn">×</a>
    <a href="" class="npv">Home</a>
    <a href="" class="hitung-1">NPV</a>
    <a href="" class="hitung-2">Lembar Perhitungan 1</a>
    <a href="" class="hitung-3">Lembar Perhitungan 2</a>
    <a href="" class="hitung-4">Lembar Perhitungan 3</a>
    <a href="" class="hitung-5">Lembar Perhitungan 5</a>
    <a href="" class="hitung-irr">LEMBAR IRR</a>
  </div>
  <div>
    <button class="open-btn" onclick="openNav()">☰</button>
  </div>
    <table class="container">
      <tr>
        <th>Interest</th>
        <td rowspan="2" class="interts"></td>
        <td class="hasil-perhitungan"></td>
      </tr>
      <tr>
        <th>∑PV</th>
        <td class="pv"></td>
      </tr>
    </table>
    <table class="container">
      <thead>
        <tr>
          <th>Bulan</th>
          <th>PV</th>
          <th>PV = FV/(1+r)<sup>n</sup></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1</td>
          <td>PV<sub>1</sub></td>
          <td class="pv-1 sama"></td>
        </tr>
        <tr>
          <td>2</td>
          <td>PV<sub>2</sub></td>
          <td class="pv-2 sama"></td>
        </tr>
        <tr>
          <td>3</td>
          <td>PV<sub>3</sub></td>
          <td class="pv-3 sama"></td>
        </tr>
        <tr>
          <td>4</td>
          <td>PV<sub>4</sub></td>
          <td class="pv-4 sama"></td>
        </tr>
        <tr>
          <td>5</td>
          <td>PV<sub>5</sub></td>
          <td class="pv-5 sama"></td>
        </tr>
        <tr>
          <td>6</td>
          <td>PV<sub>6</sub></td>
          <td class="pv-6 sama"></td>
        </tr>
        <tr>
          <td>7</td>
          <td>PV<sub>7</sub></td>
          <td class="pv-7 sama"></td>
        </tr>
        <tr>
          <td>8</td>
          <td>PV<sub>8</sub></td>
          <td class="pv-8 sama"></td>
        </tr>
        <tr>
          <td>9</td>
          <td>PV<sub>9</sub></td>
          <td class="pv-9 sama"></td>
        </tr>
        <tr>
          <td>10</td>
          <td>PV<sub>10</sub></td>
          <td class="pv-10 sama"></td>
        </tr>
        <tr>
          <td>11</td>
          <td>PV<sub>11</sub></td>
          <td class="pv-11 sama"></td>
        </tr>
      </tbody>
    </table>
    <script>
  const params = new URLSearchParams(location.search);
      const urlObjectString = params.get("url");
      const data = JSON.parse(decodeURIComponent(urlObjectString));

      const urlObjectObjeck = JSON.stringify(data);
      encodedUrlObjectString = encodeURIComponent(urlObjectObjeck);

       function openNav() {
        const sidepanel = document.getElementById("my-sidepanel");
        sidepanel.style.width = "300px";
        sidepanel.style.display = "block";
      }

      document.querySelector(".close-btn").addEventListener("click", () => {
        document.getElementById("my-sidepanel").style.width = "0";
      });

      document.querySelector(".npv").onclick = (e) => {
        e.preventDefault();
        location.href = `../?url=${encodedUrlObjectString}`;
      };
      document.querySelector(".hitung-1").onclick = (e) => {
        e.preventDefault();
        location.href = `../npv/?url=${encodedUrlObjectString}`;
      };
      document.querySelector(".hitung-2").onclick = (e) => {
        e.preventDefault();
        location.href = `../sheet1/?url=${encodedUrlObjectString}`;
      };
      document.querySelector(".hitung-3").onclick = (e) => {
        e.preventDefault();
        location.href = `../sheet2/?url=${encodedUrlObjectString}`;
      };
      document.querySelector(".hitung-4").onclick = (e) => {
        e.preventDefault();
        location.href = `../sheet3/?url=${encodedUrlObjectString}`;
      };
      document.querySelector(".hitung-5").onclick = (e) => {
        e.preventDefault();
        location.href = `../sheet5/?url=${encodedUrlObjectString}`;
      };
      document.querySelector(".hitung-irr").onclick = (e) => {
        e.preventDefault();
        location.href = `../IRR/?url=${encodedUrlObjectString}`;
      };
      document.querySelector(".interts").innerHTML =
        data.interst.intertsNpv[3] + "%";

      document.querySelector(".hasil-perhitungan").innerHTML =
        data.interst.workSheet[3].interst.toFixed(5);
      document.querySelector(".pv").innerHTML =
        "RP. " +
        data.interst.workSheet[3].sigmaPv.toLocaleString("en-US", {
          style: "decimal",
        });
      document.querySelectorAll(".sama").forEach((v, i) => {
        // console.log(i);
        const angka = data.interst.workSheet[3].pv[i].toFixed(0);
        document.querySelector(`.pv-${i + 1}`).innerHTML =
          "RP. " + parseInt(angka).toLocaleString();
      });
    </script>
  </body>
</html>
